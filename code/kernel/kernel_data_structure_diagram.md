# Yat-CASched å†…æ ¸æ•°æ®ç»“æ„å…³ç³»å›¾

## Linuxè°ƒåº¦æ¡†æ¶å±‚æ¬¡ç»“æ„

```
Linuxå†…æ ¸è°ƒåº¦æ¡†æ¶ (Scheduler Framework)
â”œâ”€â”€ è°ƒåº¦ç±»ä¼˜å…ˆçº§å±‚æ¬¡
â”‚   â”œâ”€â”€ stop_sched_class (æœ€é«˜ä¼˜å…ˆçº§)
â”‚   â”œâ”€â”€ dl_sched_class (æˆªæ­¢æ—¶é—´è°ƒåº¦)
â”‚   â”œâ”€â”€ rt_sched_class (å®æ—¶è°ƒåº¦)
â”‚   â”œâ”€â”€ fair_sched_class (CFSå…¬å¹³è°ƒåº¦)
â”‚   â”œâ”€â”€ yat_casched_sched_class â† ã€Yat-CASchedæ–°å¢ã€‘
â”‚   â””â”€â”€ idle_sched_class (ç©ºé—²è°ƒåº¦)
â”‚
â””â”€â”€ è°ƒåº¦ç­–ç•¥å¸¸é‡å®šä¹‰
    â”œâ”€â”€ SCHED_NORMAL (0)
    â”œâ”€â”€ SCHED_FIFO (1)
    â”œâ”€â”€ SCHED_RR (2)
    â”œâ”€â”€ SCHED_BATCH (3)
    â”œâ”€â”€ SCHED_IDLE (5)
    â”œâ”€â”€ SCHED_DEADLINE (6)
    â””â”€â”€ SCHED_YAT_CASCHED (8) â† ã€æ–°å¢ç­–ç•¥ã€‘
```

## æ ¸å¿ƒæ•°æ®ç»“æ„å…³ç³»

```
task_struct (è¿›ç¨‹æ§åˆ¶å—)
â”œâ”€â”€ struct sched_entity se (CFSè°ƒåº¦å®ä½“)
â”œâ”€â”€ struct rt_entity rt (å®æ—¶è°ƒåº¦å®ä½“)
â”œâ”€â”€ struct dl_entity dl (æˆªæ­¢æ—¶é—´è°ƒåº¦å®ä½“)
â””â”€â”€ struct sched_yat_casched_entity yat_casched â† ã€æ–°å¢è°ƒåº¦å®ä½“ã€‘
    â”œâ”€â”€ u64 vruntime (è™šæ‹Ÿè¿è¡Œæ—¶é—´ - 8å­—èŠ‚)
    â”œâ”€â”€ int last_cpu (ä¸Šæ¬¡è¿è¡ŒCPU - 4å­—èŠ‚)
    â”œâ”€â”€ unsigned long cache_hot (ç¼“å­˜çƒ­åº¦æ—¶é—´æˆ³ - 8å­—èŠ‚)
    â”œâ”€â”€ unsigned long last_run_time (ä¸Šæ¬¡è¿è¡Œæ—¶é—´ - 8å­—èŠ‚)
    â”œâ”€â”€ struct list_head run_list (è¿è¡Œé˜Ÿåˆ—èŠ‚ç‚¹ - 16å­—èŠ‚)
    â”œâ”€â”€ unsigned long migrate_count (è¿ç§»ç»Ÿè®¡ - 8å­—èŠ‚)
    â””â”€â”€ unsigned long cache_hit_count (ç¼“å­˜å‘½ä¸­ç»Ÿè®¡ - 8å­—èŠ‚)
    â””â”€â”€ [æ€»è®¡: 64å­—èŠ‚ = 1ä¸ªç¼“å­˜çº¿]
```

## æ¯CPUè¿è¡Œé˜Ÿåˆ—æ¶æ„

```
ç³»ç»Ÿå¤šæ ¸æ¶æ„
â”œâ”€â”€ CPU 0
â”‚   â”œâ”€â”€ struct rq (è¿è¡Œé˜Ÿåˆ—)
â”‚   â”‚   â”œâ”€â”€ struct cfs_rq cfs (CFSè¿è¡Œé˜Ÿåˆ—)
â”‚   â”‚   â”œâ”€â”€ struct rt_rq rt (å®æ—¶è¿è¡Œé˜Ÿåˆ—)
â”‚   â”‚   â””â”€â”€ struct yat_casched_rq yat_casched â† ã€æ–°å¢è¿è¡Œé˜Ÿåˆ—ã€‘
â”‚   â”‚       â”œâ”€â”€ struct list_head queue (ä»»åŠ¡é“¾è¡¨)
â”‚   â”‚       â”œâ”€â”€ unsigned int nr_running (ä»»åŠ¡æ•°é‡)
â”‚   â”‚       â”œâ”€â”€ unsigned long load_avg (å¹³å‡è´Ÿè½½)
â”‚   â”‚       â”œâ”€â”€ unsigned long cpu_history[NR_CPUS] (CPUå†å²çŸ©é˜µ)
â”‚   â”‚       â”œâ”€â”€ unsigned long local_wakeups (æœ¬åœ°å”¤é†’ç»Ÿè®¡)
â”‚   â”‚       â”œâ”€â”€ unsigned long remote_wakeups (è¿œç¨‹å”¤é†’ç»Ÿè®¡)
â”‚   â”‚       â”œâ”€â”€ unsigned long cache_hits (ç¼“å­˜å‘½ä¸­ç»Ÿè®¡)
â”‚   â”‚       â”œâ”€â”€ unsigned long cache_misses (ç¼“å­˜å¤±æ•ˆç»Ÿè®¡)
â”‚   â”‚       â””â”€â”€ raw_spinlock_t lock (é˜Ÿåˆ—ä¿æŠ¤é”)
â”‚   â””â”€â”€ L1 Cache (ç§æœ‰ç¼“å­˜)
â”œâ”€â”€ CPU 1
â”‚   â”œâ”€â”€ struct rq + struct yat_casched_rq
â”‚   â””â”€â”€ L1 Cache (ç§æœ‰ç¼“å­˜)
â”œâ”€â”€ CPU 2
â”‚   â”œâ”€â”€ struct rq + struct yat_casched_rq
â”‚   â””â”€â”€ L1 Cache (ç§æœ‰ç¼“å­˜)
â””â”€â”€ CPU 3
    â”œâ”€â”€ struct rq + struct yat_casched_rq
    â””â”€â”€ L1 Cache (ç§æœ‰ç¼“å­˜)
    
å…±äº«ç¼“å­˜å±‚æ¬¡
â”œâ”€â”€ L2 Cache (é›†ç¾¤å…±äº«)
â””â”€â”€ L3 Cache (å…¨å±€å…±äº«)
```

## è°ƒåº¦å†³ç­–æµç¨‹æ•°æ®æµ

```
è°ƒåº¦å†³ç­–å…¥å£: select_task_rq_yat_casched()
â”‚
â”œâ”€â”€ ç¬¬ä¸€å±‚å†³ç­–: åŸºç¡€å¯ç”¨æ€§éªŒè¯
â”‚   â”œâ”€â”€ æ£€æŸ¥ last_cpu æœ‰æ•ˆæ€§
â”‚   â”œâ”€â”€ æ£€æŸ¥ CPU åœ¨çº¿çŠ¶æ€ (cpu_online)
â”‚   â”œâ”€â”€ æ£€æŸ¥ CPU äº²å’Œæ€§æ©ç  (cpus_mask)
â”‚   â””â”€â”€ [æ— æ•ˆ] â†’ è¿”å› prev_cpu
â”‚
â”œâ”€â”€ ç¬¬äºŒå±‚å†³ç­–: ç¼“å­˜çƒ­åº¦åˆ†æ
â”‚   â”œâ”€â”€ è°ƒç”¨ get_cache_thermal_state(p)
â”‚   â”‚   â”œâ”€â”€ è®¡ç®— cache_age = jiffies - cache_hot
â”‚   â”‚   â”œâ”€â”€ [cache_age < 10ms] â†’ CACHE_HOT
â”‚   â”‚   â”œâ”€â”€ [cache_age < 20ms] â†’ CACHE_WARM  
â”‚   â”‚   â””â”€â”€ [cache_age >= 20ms] â†’ CACHE_COLD
â”‚   â”œâ”€â”€ CACHE_HOT â†’ è¿”å› last_cpu (å¼ºåˆ¶äº²å’Œ)
â”‚   â”œâ”€â”€ CACHE_WARM â†’ è´Ÿè½½æƒè¡¡å†³ç­–
â”‚   â”‚   â”œâ”€â”€ è·å– last_rq->load_avg
â”‚   â”‚   â”œâ”€â”€ è·å– prev_rq->load_avg
â”‚   â”‚   â”œâ”€â”€ [è´Ÿè½½å·®å¼‚ < é˜ˆå€¼] â†’ è¿”å› last_cpu
â”‚   â”‚   â””â”€â”€ [è´Ÿè½½å·®å¼‚ >= é˜ˆå€¼] â†’ è¿›å…¥ç¬¬ä¸‰å±‚
â”‚   â””â”€â”€ CACHE_COLD â†’ è¿›å…¥ç¬¬ä¸‰å±‚
â”‚
â””â”€â”€ ç¬¬ä¸‰å±‚å†³ç­–: è´Ÿè½½å‡è¡¡
    â”œâ”€â”€ æ›´æ–° migrate_count++
    â””â”€â”€ è°ƒç”¨ select_idle_sibling() â†’ è¿”å›æœ€ä¼˜CPU
```

## ç¼“å­˜æ„ŸçŸ¥æ—¶é—´çª—å£æœºåˆ¶

```
æ—¶é—´è½´ (ä»¥jiffiesä¸ºå•ä½)
â”‚
â”œâ”€â”€ T0: ä»»åŠ¡å¼€å§‹è¿è¡Œ
â”‚   â””â”€â”€ cache_hot = jiffies (åˆ·æ–°ç¼“å­˜çƒ­åº¦)
â”‚
â”œâ”€â”€ T0 + 10ms: CACHE_HOT è¾¹ç•Œ
â”‚   â”œâ”€â”€ [0ms - 10ms] å¼ºåˆ¶CPUäº²å’Œæ€§
â”‚   â””â”€â”€ ç¼“å­˜æ•°æ®ä»åœ¨ L1/L2 ä¸­
â”‚
â”œâ”€â”€ T0 + 20ms: CACHE_WARM è¾¹ç•Œ  
â”‚   â”œâ”€â”€ [10ms - 20ms] æƒè¡¡è´Ÿè½½ä¸äº²å’Œæ€§
â”‚   â””â”€â”€ ç¼“å­˜æ•°æ®å¯èƒ½åœ¨ L2/L3 ä¸­
â”‚
â””â”€â”€ T0 + 100ms: CACHE_COLD è¾¹ç•Œ
    â”œâ”€â”€ [20ms+] ä¼˜å…ˆè´Ÿè½½å‡è¡¡
    â””â”€â”€ ç¼“å­˜æ•°æ®å¯èƒ½å·²å¤±æ•ˆ
```

## è°ƒåº¦ç±»æ¥å£å®ç°å…³ç³»

```
struct sched_class yat_casched_sched_class
â”œâ”€â”€ æ ¸å¿ƒè°ƒåº¦æ“ä½œ
â”‚   â”œâ”€â”€ .enqueue_task = enqueue_task_yat_casched
â”‚   â”œâ”€â”€ .dequeue_task = dequeue_task_yat_casched  
â”‚   â”œâ”€â”€ .pick_next_task = pick_next_task_yat_casched
â”‚   â””â”€â”€ .put_prev_task = put_prev_task_yat_casched
â”œâ”€â”€ SMPå¤šæ ¸æ”¯æŒ
â”‚   â”œâ”€â”€ .select_task_rq = select_task_rq_yat_casched â† ã€æ ¸å¿ƒç®—æ³•ã€‘
â”‚   â”œâ”€â”€ .migrate_task_rq = migrate_task_rq_yat_casched
â”‚   â”œâ”€â”€ .task_waking = task_waking_yat_casched
â”‚   â”œâ”€â”€ .rq_online = rq_online_yat_casched
â”‚   â””â”€â”€ .rq_offline = rq_offline_yat_casched
â”œâ”€â”€ æ—¶é—´ç®¡ç†
â”‚   â”œâ”€â”€ .task_tick = task_tick_yat_casched
â”‚   â”œâ”€â”€ .task_fork = task_fork_yat_casched
â”‚   â””â”€â”€ .task_dead = task_dead_yat_casched
â”œâ”€â”€ ç­–ç•¥åˆ‡æ¢
â”‚   â”œâ”€â”€ .switched_to = switched_to_yat_casched
â”‚   â”œâ”€â”€ .switched_from = switched_from_yat_casched
â”‚   â””â”€â”€ .prio_changed = prio_changed_yat_casched
â””â”€â”€ æŠ¢å æ§åˆ¶
    â””â”€â”€ .check_preempt_curr = check_preempt_curr_yat_casched
```

## å†…å­˜å¸ƒå±€ä¸ç¼“å­˜ä¼˜åŒ–

```
ç¼“å­˜è¡Œå¯¹é½è®¾è®¡ (64å­—èŠ‚ç¼“å­˜è¡Œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  struct sched_yat_casched_entity        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ çƒ­ç‚¹æ•°æ®åŒº (å‰32å­—èŠ‚)                â”‚ â”‚
â”‚  â”‚ â”œâ”€ vruntime (8B)                    â”‚ â”‚
â”‚  â”‚ â”œâ”€ last_cpu (4B)                    â”‚ â”‚
â”‚  â”‚ â”œâ”€ cache_hot (8B)                   â”‚ â”‚
â”‚  â”‚ â””â”€ last_run_time (8B)               â”‚ â”‚
â”‚  â”‚ â””â”€ padding (4B)                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç»Ÿè®¡æ•°æ®åŒº (å32å­—èŠ‚)                â”‚ â”‚
â”‚  â”‚ â”œâ”€ run_list (16B)                   â”‚ â”‚
â”‚  â”‚ â”œâ”€ migrate_count (8B)               â”‚ â”‚
â”‚  â”‚ â””â”€ cache_hit_count (8B)             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ€§èƒ½ç›‘æ§ä¸è°ƒè¯•æ¥å£

```
è°ƒè¯•ä¿¡æ¯è·å–è·¯å¾„
â”œâ”€â”€ /proc/sched_debug
â”‚   â”œâ”€â”€ æ˜¾ç¤º yat_casched è°ƒåº¦ç±»çŠ¶æ€
â”‚   â”œâ”€â”€ æ˜¾ç¤ºå„CPUè¿è¡Œé˜Ÿåˆ—ä¿¡æ¯
â”‚   â””â”€â”€ æ˜¾ç¤ºè°ƒåº¦ç»Ÿè®¡æ•°æ®
â”œâ”€â”€ trace events
â”‚   â”œâ”€â”€ trace_sched_yat_pick_next_task
â”‚   â”œâ”€â”€ trace_sched_yat_put_prev_task
â”‚   â””â”€â”€ trace_sched_yat_migrate_task
â””â”€â”€ æ€§èƒ½è®¡æ•°å™¨
    â”œâ”€â”€ cache_hits / cache_misses æ¯”ç‡
    â”œâ”€â”€ migrate_count ç»Ÿè®¡
    â”œâ”€â”€ local_wakeups / remote_wakeups æ¯”ç‡
    â””â”€â”€ CPUä½¿ç”¨å†å²çƒ­åŠ›å›¾
```

---

**å›¾ç‰‡è¯´æ˜**: è¿™ä¸ªç»“æ„å›¾å±•ç¤ºäº†Yat-CASchedè°ƒåº¦å™¨åœ¨Linuxå†…æ ¸ä¸­çš„å®Œæ•´é›†æˆæ¶æ„ï¼ŒåŒ…æ‹¬æ•°æ®ç»“æ„å…³ç³»ã€è°ƒåº¦å†³ç­–æµç¨‹ã€å†…å­˜å¸ƒå±€ä¼˜åŒ–å’Œæ€§èƒ½ç›‘æ§æœºåˆ¶ã€‚é‡ç‚¹çªå‡ºäº†ç¼“å­˜æ„ŸçŸ¥è°ƒåº¦çš„æ ¸å¿ƒè®¾è®¡æ€æƒ³å’Œå·¥ç¨‹å®ç°ç»†èŠ‚ã€‚

---

# Yat-CASched å†…æ ¸æ•°æ®ç»“æ„å®Œæ•´å…³ç³»å›¾

```
                    ğŸ–¥ï¸ Linuxå†…æ ¸è°ƒåº¦æ¡†æ¶ (Scheduler Framework)
                                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                              â”‚                               â”‚
   ğŸ“‹ è°ƒåº¦ç±»ä¼˜å…ˆçº§å±‚æ¬¡              ğŸ“Š è°ƒåº¦ç­–ç•¥å¸¸é‡å®šä¹‰            ğŸ”§ ç³»ç»Ÿè°ƒç”¨æ¥å£
   â”œâ”€ stop_sched_class          â”œâ”€ SCHED_NORMAL (0)           â”œâ”€ sched_setscheduler()
   â”œâ”€ dl_sched_class            â”œâ”€ SCHED_FIFO (1)             â”œâ”€ sched_getscheduler()
   â”œâ”€ rt_sched_class            â”œâ”€ SCHED_RR (2)               â””â”€ sched_setaffinity()
   â”œâ”€ fair_sched_class          â”œâ”€ SCHED_BATCH (3)
   â”œâ”€ ğŸ¯ yat_casched_class â†    â”œâ”€ SCHED_IDLE (5)
   â””â”€ idle_sched_class          â”œâ”€ SCHED_DEADLINE (6)
                               â””â”€ ğŸ¯ SCHED_YAT_CASCHED (8) â†
                                        â”‚
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                     ğŸ“ task_struct (è¿›ç¨‹æ§åˆ¶å—)                      â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ sched_entity se â”‚  rt_entity rt   â”‚ ğŸ¯ sched_yat_casched_entity â”‚  â”‚
    â”‚  â”‚    (CFSè°ƒåº¦)    â”‚   (RTè°ƒåº¦)      â”‚      yat_casched â†          â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         ğŸ’¾ sched_yat_casched_entity (64å­—èŠ‚ç¼“å­˜è¡Œå¯¹é½)                â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚        ğŸ”¥ çƒ­ç‚¹æ•°æ®åŒº (32B)       â”‚        ğŸ“ˆ ç»Ÿè®¡æ•°æ®åŒº (32B)       â”‚  â”‚
    â”‚  â”‚  â”œâ”€ u64 vruntime (8B)          â”‚  â”œâ”€ list_head run_list (16B)    â”‚  â”‚
    â”‚  â”‚  â”œâ”€ int last_cpu (4B) â­        â”‚  â”œâ”€ ulong migrate_count (8B)    â”‚  â”‚
    â”‚  â”‚  â”œâ”€ ulong cache_hot (8B) â­     â”‚  â””â”€ ulong cache_hit_count (8B)  â”‚  â”‚
    â”‚  â”‚  â”œâ”€ ulong last_run_time (8B)    â”‚                                 â”‚  â”‚
    â”‚  â”‚  â””â”€ padding (4B)               â”‚                                 â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    ğŸ—ï¸ å¤šæ ¸è¿è¡Œé˜Ÿåˆ—æ¶æ„ (SMP)                         â”‚
    â”‚                                                                     â”‚
    â”‚   CPU 0           CPU 1           CPU 2           CPU 3            â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚  â”‚struct rqâ”‚     â”‚struct rqâ”‚     â”‚struct rqâ”‚     â”‚struct rqâ”‚       â”‚
    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚     â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚     â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚     â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚       â”‚
    â”‚  â”‚ â”‚ cfs â”‚ â”‚     â”‚ â”‚ cfs â”‚ â”‚     â”‚ â”‚ cfs â”‚ â”‚     â”‚ â”‚ cfs â”‚ â”‚       â”‚
    â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”¤ â”‚     â”‚ â”œâ”€â”€â”€â”€â”€â”¤ â”‚     â”‚ â”œâ”€â”€â”€â”€â”€â”¤ â”‚     â”‚ â”œâ”€â”€â”€â”€â”€â”¤ â”‚       â”‚
    â”‚  â”‚ â”‚ rt  â”‚ â”‚     â”‚ â”‚ rt  â”‚ â”‚     â”‚ â”‚ rt  â”‚ â”‚     â”‚ â”‚ rt  â”‚ â”‚       â”‚
    â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”¤ â”‚     â”‚ â”œâ”€â”€â”€â”€â”€â”¤ â”‚     â”‚ â”œâ”€â”€â”€â”€â”€â”¤ â”‚     â”‚ â”œâ”€â”€â”€â”€â”€â”¤ â”‚       â”‚
    â”‚  â”‚ â”‚ğŸ¯yatâ”‚ â”‚â—„â”€â”€â”€â”€â”¼â”€â”‚ğŸ¯yatâ”‚ â”‚â—„â”€â”€â”€â”€â”¼â”€â”‚ğŸ¯yatâ”‚ â”‚â—„â”€â”€â”€â”€â”¼â”€â”‚ğŸ¯yatâ”‚ â”‚       â”‚
    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚     â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚     â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚     â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚       â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
    â”‚      â”‚               â”‚               â”‚               â”‚             â”‚
    â”‚   L1 Cache        L1 Cache        L1 Cache        L1 Cache        â”‚
    â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                   L2 Cache        L2 Cache                        â”‚
    â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
    â”‚                         L3 Cache (å…±äº«)                           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚               ğŸ§  ä¸‰å±‚æ™ºèƒ½è°ƒåº¦å†³ç­–ç®—æ³•æµç¨‹                             â”‚
    â”‚                                                                     â”‚
    â”‚  ğŸ“ select_task_rq_yat_casched(task, prev_cpu, flags)              â”‚
    â”‚                         â”‚                                           â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
    â”‚    â”‚          ğŸ” ç¬¬ä¸€å±‚ï¼šå¯ç”¨æ€§éªŒè¯            â”‚                     â”‚
    â”‚    â”‚  â”Œâ”€ last_cpu æœ‰æ•ˆï¼Ÿ                     â”‚                     â”‚
    â”‚    â”‚  â”œâ”€ CPUåœ¨çº¿ï¼Ÿ(cpu_online)                â”‚                     â”‚
    â”‚    â”‚  â””â”€ äº²å’Œæ€§å…è®¸ï¼Ÿ(cpus_mask)              â”‚                     â”‚
    â”‚    â”‚     â”‚ [æ— æ•ˆ] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                     â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
    â”‚          â”‚                  â”‚                                       â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
    â”‚    â”‚     ğŸŒ¡ï¸ ç¬¬äºŒå±‚ï¼šç¼“å­˜çƒ­åº¦åˆ†æ              â”‚                     â”‚
    â”‚    â”‚  â”Œâ”€ cache_age = jiffies - cache_hot     â”‚                     â”‚
    â”‚    â”‚  â”œâ”€ [0-10ms] â†’ CACHE_HOT â†’ last_cpu â”€â”€â”€â”€â”¼â”€â”€â”                  â”‚
    â”‚    â”‚  â”œâ”€ [10-20ms] â†’ CACHE_WARM â†’ è´Ÿè½½æƒè¡¡    â”‚  â”‚                  â”‚
    â”‚    â”‚  â””â”€ [20ms+] â†’ CACHE_COLD                â”‚  â”‚                  â”‚
    â”‚    â”‚     â”‚                                   â”‚  â”‚                  â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                  â”‚
    â”‚          â”‚                                      â”‚                  â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚                  â”‚
    â”‚    â”‚  âš–ï¸ ç¬¬ä¸‰å±‚ï¼šè´Ÿè½½å‡è¡¡    â”‚                   â”‚                  â”‚
    â”‚    â”‚  â”Œâ”€ migrate_count++     â”‚                   â”‚                  â”‚
    â”‚    â”‚  â””â”€ select_idle_sibling â”‚                   â”‚                  â”‚
    â”‚    â”‚     â”‚                   â”‚                   â”‚                  â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚                  â”‚
    â”‚          â”‚                                       â”‚                  â”‚
    â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
    â”‚                          â–¼                                          â”‚
    â”‚                    ğŸ¯ è¿”å›æœ€ä¼˜CPU                                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    â±ï¸ ç¼“å­˜çƒ­åº¦æ—¶é—´çª—å£æœºåˆ¶                           â”‚
    â”‚                                                                     â”‚
    â”‚  T0 â”€â”€â”€â”€â”€â”€â†’ T0+10ms â”€â”€â”€â”€â”€â”€â†’ T0+20ms â”€â”€â”€â”€â”€â”€â”€â”€â†’ T0+100ms             â”‚
    â”‚   â”‚           â”‚              â”‚                  â”‚                  â”‚
    â”‚   â”‚    ğŸ”¥ CACHE_HOT    ğŸŒ¡ï¸ CACHE_WARM     â„ï¸ CACHE_COLD            â”‚
    â”‚   â”‚    å¼ºåˆ¶äº²å’Œæ€§       è´Ÿè½½æƒè¡¡          è´Ÿè½½ä¼˜å…ˆ               â”‚
    â”‚   â”‚    L1/L2ç¼“å­˜       L2/L3ç¼“å­˜         ç¼“å­˜å¤±æ•ˆ               â”‚
    â”‚   â”‚                                                                 â”‚
    â”‚   â””â”€ cache_hot = jiffies (æ—¶é—´æˆ³åˆ·æ–°)                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  ğŸ”§ è°ƒåº¦ç±»æ¥å£å®Œæ•´å®ç°                                â”‚
    â”‚                                                                     â”‚
    â”‚  struct sched_class yat_casched_sched_class = {                     â”‚
    â”‚    ğŸ“‹ æ ¸å¿ƒè°ƒåº¦æ“ä½œ                   ğŸŒ SMPå¤šæ ¸æ”¯æŒ                  â”‚
    â”‚    â”œâ”€ .enqueue_task                â”œâ”€ .select_task_rq â­ (æ ¸å¿ƒ)      â”‚
    â”‚    â”œâ”€ .dequeue_task                â”œâ”€ .migrate_task_rq              â”‚
    â”‚    â”œâ”€ .pick_next_task              â”œâ”€ .task_waking                  â”‚
    â”‚    â””â”€ .put_prev_task               â”œâ”€ .rq_online                    â”‚
    â”‚                                    â””â”€ .rq_offline                   â”‚
    â”‚    â° æ—¶é—´ç®¡ç†                      ğŸ”„ ç­–ç•¥åˆ‡æ¢                      â”‚
    â”‚    â”œâ”€ .task_tick                   â”œâ”€ .switched_to                  â”‚
    â”‚    â”œâ”€ .task_fork                   â”œâ”€ .switched_from                â”‚
    â”‚    â””â”€ .task_dead                   â””â”€ .prio_changed                 â”‚
    â”‚                                                                     â”‚
    â”‚    âš¡ æŠ¢å æ§åˆ¶: .check_preempt_curr                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    ğŸ“Š æ€§èƒ½ç›‘æ§ä¸è°ƒè¯•ç³»ç»Ÿ                             â”‚
    â”‚                                                                     â”‚
    â”‚  ğŸ“ /proc/sched_debug        ğŸ“ˆ æ€§èƒ½è®¡æ•°å™¨           ğŸ” trace events â”‚
    â”‚  â”œâ”€ yat_caschedçŠ¶æ€          â”œâ”€ cache_hits          â”œâ”€ pick_next     â”‚
    â”‚  â”œâ”€ è¿è¡Œé˜Ÿåˆ—ä¿¡æ¯             â”œâ”€ cache_misses        â”œâ”€ put_prev      â”‚
    â”‚  â””â”€ è°ƒåº¦ç»Ÿè®¡                 â”œâ”€ migrate_count       â””â”€ migrate_task  â”‚
    â”‚                             â”œâ”€ local_wakeups                        â”‚
    â”‚  ğŸ“‹ ç”¨æˆ·æ€æ¥å£               â””â”€ remote_wakeups       ğŸ“Š ç»Ÿè®¡è¾“å‡º      â”‚
    â”‚  â”œâ”€ sched_setscheduler()                           â”œâ”€ CPUåˆ‡æ¢ç‡: -62.8% â”‚
    â”‚  â”œâ”€ SCHED_YAT_CASCHED=8                           â”œâ”€ L1å‘½ä¸­ç‡: +7.7%   â”‚
    â”‚  â””â”€ ç¼“å­˜äº²å’Œæ€§ç›‘æ§                                  â””â”€ æ€§èƒ½æå‡: +12.7%  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            ğŸ¯ Yat-CASched ç¼“å­˜æ„ŸçŸ¥è°ƒåº¦å™¨
                               ç†è®º â†’ ä»¿çœŸ â†’ å†…æ ¸å®ç°
                              å±€éƒ¨æ€§ä¼˜å…ˆï¼Œå…¨å±€å¹³è¡¡ç­–ç•¥

æ ¸å¿ƒç‰¹æ€§æ€»è§ˆ:
- ğŸ¯ ä¸‰å±‚æ™ºèƒ½å†³ç­–: å¯ç”¨æ€§ â†’ ç¼“å­˜çƒ­åº¦ â†’ è´Ÿè½½å‡è¡¡
- â±ï¸ 10msæ—¶é—´çª—å£: ç¡¬ä»¶ç‰¹æ€§åŒ¹é…çš„ç¼“å­˜çƒ­åº¦åˆ¤æ–­
- ğŸ’¾ 64å­—èŠ‚å¯¹é½: å•ç¼“å­˜è¡Œå†…çš„é«˜æ•ˆæ•°æ®ç»“æ„
- ğŸŒ SMPæ”¯æŒ: å®Œæ•´çš„å¤šæ ¸è´Ÿè½½å‡è¡¡æœºåˆ¶
- ğŸ”§ ç”Ÿäº§å°±ç»ª: å®Œæ•´Linuxå†…æ ¸è°ƒåº¦ç±»å®ç°
```
